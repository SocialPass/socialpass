{% extends "bases/base_primary.html" %}
{% load static get_user_primary_email %}

{% block head_title %}Change Password - SocialPass{% endblock head_title %}

{% block navbar_breadcrumb %}Change Password{% endblock %}

{% block content %}
<!-- Header start -->
<div class="border-bottom hs-md-100">
	<div class="p-content d-flex h-100">
		<div class="align-self-center">
			<h1 class="content-title m-0 fs-base-p6">Change Password</h1>
			<p class="text-muted mt-5 mt-5 mb-0 fs-base-n2">
				Use the following form to change your password.
			</p>
		</div>
	</div>
</div>
<!-- Header end -->

<!-- Content card start -->
<div class="card rounded-0 border-top-transparent border-start-0 border-end-0 p-0 m-0">
	<!-- Card header start -->
	<div class="px-card py-10 border-bottom">
		<span class="bg-primary-very-light-lm bg-primary-very-dim-dm border-start border-primary border-2 px-10 py-5 fs-base-n2 fw-bold">
			Change Password Form
		</span>
	</div>
	<!-- Card header end -->

	<div class="row">
		<!-- Main content start -->
		<div class="col-lg-6 border-lg-end">
			<div class="content">
				<p class="fs-base-n2">
					You're changing the password as...<br />
					<strong>{{ request.user.username }}</strong> - <a href="mailto:{% get_user_primary_email %}" target="_blank" class="fw-bold">{% get_user_primary_email %}</a>
				</p>

				<!-- Form start -->
				<form method="POST" action="{% url 'account_change_password' %}">
					{% csrf_token %}

					{% if form.non_field_errors %}
						<div class="alert alert-danger" role="alert">
							<ul class="invalid-feedback">
								{% for error in form.non_field_errors %}
									<li>{{ error|escape }}</li>
								{% endfor %}
							</ul>
						</div>
					{% endif %}

					{% for input in form.hidden_fields %}
						{{ input }}
					{% endfor %}

					{% for input in form.visible_fields %}
						<div class="form-group">
							<label class="form-label" for="{{ input.id_for_label }}">{{ input.label }}</label>
							<input
								type="{{ input.field.widget.input_type }}"
								name="{{ input.name }}"
								value="{{ input.value|default_if_none:'' }}"
								{% if input.field.widget.input_type != "hidden" %}
									class="form-control {% if input.errors %}is-invalid{% endif %}"
									id="{{ input.auto_id }}"
								{% endif %}
								{% if input.field.required %}
									required="required"
								{% endif %}
								{% for k,v in input.field.widget.attrs.items %}
									{{ k }}="{{ v }}"
								{% endfor %}
								{% if input.name == "oldpassword" %}
									autofocus="true"
								{% endif %}
							/>

							{% if input.errors %}
								<ul class="invalid-feedback">
									{% for error in input.errors %}
										<li>{{ error }}</li>
									{% endfor %}
								</ul>
							{% endif %}
						</div>
					{% endfor %}

					<div class="form-group text-end">
						<button class="btn btn-primary" type="submit">Change Password</button>
					</div>
				</form>
				<!-- Form end -->
			</div>
		</div>
		<!-- Main content end -->

		<!-- Illustration start -->
		<div class="col-lg-6 d-none d-lg-flex align-items-center justify-content-center ">
			<div class="content w-100">
				<img src="{% static 'images/illustrations/change_password.svg' %}" class="img-fluid mx-auto d-block" alt="change_password">
			</div>
		</div>
		<!-- Illustration end -->
	</div>

	<!-- Card footer start -->
	<div class="px-card py-10 border-top text-muted fs-base-n2">
		Please <a href="mailto:support@socialpass.io" target="_blank" class="fw-bold">contact us</a> and let us know if you have any trouble changing your password.
	</div>
	<!-- Card footer end -->
</div>
<!-- Content card end -->
{% endblock content %}
