{% extends "bases/base_secondary.html" %}

{% load account %}

{% block head_title %}Change Password - SocialPass{% endblock %}

{% block inner %}
<p class="mb-5">
	<a href="{% url 'account_login' %}" class="fw-bold"><i class="fa-regular fa-arrow-left me-5"></i> Sign In</a>
</p>
<h1 class="fsr-3 text-strong fw-700 mt-0">{% if token_fail %}Bad Token{% else %}Change Password{% endif %}</h1>

{% if token_fail %}
	{% url 'account_reset_password' as passwd_reset_url %}
	<p>
		The password reset link was invalid, possibly because it has already been used. Please request a <a href="{{ passwd_reset_url }}" class="fw-bold">new password reset</a>.
	</p>
{% else %}
	{% if form %}
		<p>
			Please use the form below to reset your password.
		</p>
		<form method="POST" action=".">
			{% csrf_token %}

			{% if form.non_field_errors %}
				<div class="alert alert-danger" role="alert">
					<ul class="invalid-feedback">
						{% for error in form.non_field_errors %}
							<li>{{ error|escape }}</li>
						{% endfor %}
					</ul>
				</div>
			{% endif %}

			{% for input in form.hidden_fields %}
				{{ input }}
			{% endfor %}

			{% for input in form.visible_fields %}
				<div class="form-group">
					<label class="form-label" for="{{ input.id_for_label }}">{{ input.label }}</label>
					<input
						type="{{ input.field.widget.input_type }}"
						name="{{ input.name }}"
						value="{{ input.value|default_if_none:'' }}"
						{% if input.field.widget.input_type != "hidden" %}
							class="form-control"
							id="{{ input.auto_id }}"
						{% endif %}
						{% if input.field.required %}
							required="required"
						{% endif %}
						{% for k,v in input.field.widget.attrs.items %}
							{{ k }}="{{ v }}"
						{% endfor %}
						{% if input.name == "password1" %}
							autofocus="true"
						{% endif %}
					/>

					{% if input.errors %}
						<ul class="invalid-feedback">
							{% for error in input.errors %}
								<li>{{ error }}</li>
							{% endfor %}
						</ul>
					{% endif %}
				</div>
			{% endfor %}

			<div class="form-group">
				<button class="btn btn-primary btn-block" type="submit">Change Password</button>
			</div>
		</form>
	{% else %}
		<p>
			You password has been changed.
		</p>
	{% endif %}
{% endif %}

<p class="text-muted fs-base-n2 pt-10 border-top border-dotted border-bottom-0 border-start-0 border-end-0">
	Please <a href="https://nftylabs.typeform.com/to/A70KW4vo" class="fw-bold" target="_blank">contact us</a> and let us know if you have any trouble changing your password.
</p>
{% endblock %}

