{% extends "dashboard_organizer/base.html" %}
{% load static i18n get_theme_value get_user_primary_email crispy_forms_tags %}

{% block head_title %}{% trans "Overview" %} | {{ event.title }} - SocialPass{% endblock head_title %}

{% block navbar_title %}<span class="text-primary-emphasis">{{ event.title }}</span>{% endblock navbar_title %}

{% block navbar_title_2 %}<span class="text-primary-emphasis">{{ event.title }}</span>{% endblock navbar_title_2 %}

{% block sticky_navbar_tabs %}
{% include "dashboard_organizer/event_details_tabs.html" %}
{% endblock sticky_navbar_tabs %}

{% block content %}
<div class="mw-100 mx-auto mt-4 mb-3" style="width: 720px;">
	<h1 class="h3 mb-0">{% trans "Overview" %}</h1>
	<p class="text-body-secondary mb-0">
		{% trans "View and edit your event details." %}
	</p>
</div>
<div class="card border-0 rounded-4 shadow-sm mb-3 mw-100 mx-auto" style="width: 720px;">
	{% include "dashboard_organizer/event_form.html" %}
</div>
{% endblock content %}

{% block extra_body %}
<script>
	var startDateInput = document.getElementById("id_start_date");
	var endDateInput = document.getElementById("id_end_date");
	var endDateExtraFeedback = document.getElementById("end-date-extra-feedback");

	function dateValidate(e) {
		var startDateVal = startDateInput.value;
		var endDateVal = endDateInput.value;

		endDateExtraFeedback.classList.add("d-none");
		endDateInput.classList.remove("is-invalid");

		if (startDateVal && endDateVal) {
			var startDate = new Date(startDateVal);
			var endDate = new Date(endDateVal);

			if (startDate >= endDate) {
				endDateExtraFeedback.classList.remove("d-none");
				endDateInput.classList.add("is-invalid");
			}
		}
	}

	startDateInput.addEventListener("change", dateValidate);
	endDateInput.addEventListener("change", dateValidate);
</script>
<script type="text/javascript">
	const coverImgPlaceholder = document.getElementById("cover-img-placeholder").value;
	const coverImgBg = document.getElementById("cover-img-bg");
	const coverImgPreview = document.getElementById("cover-img-preview");
	const coverImgInput = document.getElementById("id_cover_image");
	coverImgInput.addEventListener("change", function(event) {
		const [file] = coverImgInput.files;
		if (file) {
			coverImgBg.src = URL.createObjectURL(file);
			coverImgPreview.src = URL.createObjectURL(file);
		}
		else {
			coverImgBg.src = coverImgPlaceholder;
			coverImgPreview.src = coverImgPlaceholder;
		}
	});
</script>
{% endblock %}
