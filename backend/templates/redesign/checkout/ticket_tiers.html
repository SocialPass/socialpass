{% load i18n %}
{% for tier in tiers %}

<!-- Handle tier filtering -->
{% with tier_hidden=tier.hidden %}
{% if not tier_hidden or tier.hidden and is_team_member %}
{% if tier_type == "tiers-FREE" and tier.tier_free or tier_type == "tiers-FIAT" and tier.tier_fiat or tier_type == "tiers-ASSET_OWNERSHIP" and tier.tier_asset_ownership %}
<div class="ticket-tier mb-3">
    <input
        id="{{ tier.public_id }}"
        {% if tier.capacity <= tier.quantity_sold_without_party %}disabled{% endif %}
        type="checkbox"
        class="ticket-tier-input"
        data-pk="{{ tier.id }}"
        data-max-per-person="{{ tier.max_per_person }}"
        data-availability="{{ tier.availability }}"
        data-amount="0"
        data-extra-party="0"
        data-allowed-guests="{{ tier.allowed_guests }}"
        data-price-per-ticket="{{ tier.tier_fiat.price_per_ticket }}"
        onchange="tierOnchange(this)"
    >
    <label for="{{ tier.public_id }}" class="ticket-tier-label">
        <div class="d-sm-flex align-items-center">
            <div class="pe-sm-3">
                <h5 class="mb-1">
                    {% if tier.availability > 0 %}
                        <span class="ticket-tier-uncheck">
                            <i class="fa-light fa-square"></i>
                        </span>
                        <span class="ticket-tier-check">
                            <i class="fa-solid fa-check-square"></i>
                        </span>
                    {% endif %}
                    {{ tier.ticket_type }}
                </h5>
                <p class="m-0">
                    {% if tier.availability < 1 %}
                        <strong class="text-danger-emphasis">
                            <i class="fa-light fa-ban me-1"></i> {% trans "Sold out!" %}
                        </strong>
                    {% else %}
                        {{ tier.availability }} {% trans "available" %}
                        {% if tier.allowed_guests > 0 %}
                            <span>
                                | + {{ tier.allowed_guests }} {% trans "Guest(s) Allowed" %}
                            </span>
                        {% endif %}
                    {% endif %}
                </p>
            </div>
            <div class="ticket-tier-controls ms-auto mt-2 mt-sm-0">
                <div class="input-group input-group-sm input-group-pill specific-w-100 mx-auto">
                    <button class="btn btn-secondary specific-w-25 px-0" onclick="subtractAmount(this)">-</button>
                    <input type="text" class="ticket-tier-amount form-control text-center" readonly value="0">
                    <button class="btn btn-secondary specific-w-25 px-0" onclick="addAmount(this)">+</button>
                </div>
                <div class="text-body-secondary text-center mt-1" style="font-size: var(--bs-font-size-sm);">
                    {% trans "Max per person:" %} {{ tier.max_per_person }}
                </div>
            </div>
        </div>
        {% if tier.tier_free %}
            <div class="border-top mt-2 pt-2">
                <div class="rounded-pill px-3 py-2 bg-primary-subtle border border-primary lh-sm d-inline-block mt-2">
                    <i class="fa-light fa-tag me-1"></i>
                    <strong>{% trans "Price: FREE" %}</strong>
                </div>
                <div class="text-body-secondary mt-3 d-flex align-items-start">
                    <i class="fa-light fa-info-circle me-2 mt-1 flex-shrink-0"></i>
                    {% trans "Tickets are first come, first served." %}
                </div>
            </div>
        {% endif %}
        {% if tier.tier_fiat %}
            <div class="border-top mt-2 pt-2">
                <div class="rounded-pill px-3 py-2 bg-primary-subtle border border-primary lh-sm d-inline-block mt-2">
                    <i class="fa-light fa-tag me-1"></i>
                    <strong>{% trans "Price" %} &times; 1: </strong> {{ tier.event.currency_symbol }}{{ tier.tier_fiat.price_per_ticket }}
                </div>
                <div class="text-body-secondary mt-3 d-flex align-items-start">
                    <i class="fa-light fa-info-circle me-2 mt-1 flex-shrink-0"></i>
                    {% trans "Purchase with debit, credit, or Apple Pay." %}
                </div>
            </div>
        {% endif %}
        {% if tier.tier_asset_ownership %}
            <div class="border-top mt-2 pt-2">
                <div>{% trans "Free for all holders of the following:" %}</div>
                <div class="row mt-2">
                    <div class="col-6 text-truncate">
                        <strong>{% trans "Blockchain" %}</strong>
                        <br />
                        {{ tier.tier_asset_ownership.blockchain }}
                    </div>
                    <div class="col-6 text-truncate">
                        <strong>{% trans "Network" %}</strong>
                        <br />
                        {{ tier.tier_asset_ownership.get_network_display }}
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-6 text-truncate">
                        <strong>{% trans "Asset Type" %}</strong>
                        <br />
                        <i class="fa-light fa-hexagon-image"></i> {{ tier.tier_asset_ownership.asset_type }}
                    </div>
                    <div class="col-6 text-truncate">
                        <strong>{% trans "Token Address" %}</strong>
                        <br />
                        {{ tier.tier_asset_ownership.token_address }}
                    </div>
                </div>
            </div>
        {% endif %}
        {% if tier.allowed_guests > 0 %}
            <div class="ticket-tier-guest ticket-tier-controls border-top mt-2 pt-3">
                <div class="d-sm-flex align-items-center">
                    <div>
                        <div class="fw-bold">{% trans "Extra Guest(s) - Free" %}</div>
                        <div class="lh-sm" style="font-size: var(--bs-font-size-sm);">
                            {% trans "Please set the number of guest(s) you want to bring." %}
                        </div>
                    </div>
                    <div class="ms-auto mt-2 mt-sm-0">
                        <div class="input-group input-group-sm input-group-pill specific-w-100 mx-auto">
                            <button class="btn btn-secondary specific-w-25 px-0" onclick="subtractExtraParty(this)">-</button>
                            <input type="text" class="ticket-tier-extra-party form-control text-center" readonly value="0">
                            <button class="btn btn-secondary specific-w-25 px-0" onclick="addExtraParty(this)">+</button>
                        </div>
                    </div>
                </div>
                <div class="border-top text-end mt-3 pt-2">
                    <strong>{% trans "Total" %}:</strong> <span class="ticket-tier-total-selected">1</span> {% trans "(Quantity + Quantity Ã— Guests)" %}
                </div>
            </div>
        {% endif %}
    </label>
</div>
{% endif %}
{% endif %}
{% endwith %}
{% endfor %}